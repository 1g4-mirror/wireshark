commit e3c0d96060
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Aug 26 13:09:19 2024 -0700

    Prep for 4.2.7

    [skip ci]

commit c9a96a2233
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Aug 25 09:31:14 2024 +0000

    [Automatic update for 2024-08-25]

    Update manuf, services enterprise numbers, translations, and other items.

commit 99c453b5ff
Author: Dr. Lars Völker <lars.voelker@technica-engineering.de>
Date:   Fri Aug 23 00:11:00 2024 +0200

    File-blf: Allow for log containers to not have data (BUGFIX)

    This fixes a warning of malformed blf files.

commit a1b294ce3a
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Aug 22 13:09:18 2024 +0000

    wslua+lrexlib: Upstream fix for redefined symbol

    lrexlib, for compatibility, defines lua_objlen on Lua > 5.1 as it
    was removed (rather than on 5.1 defining the new symbol.)

    However if Lua 5.2 or greater is compiled in compatibility mode,
    then the Lua library itself provides a compatibility macro, and with a
    definition equivalent in practice but just different enough that some
    compilers will complain about redefined macros. This is the case with,
    e.g., the RHEL 8 Lua 5.3 packages.

    Get the new upstream fix from git for the issue.

    (cherry picked from commit 22b1d3a63683a111de423a0c303c57ba5ba2b403)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 7888b6ea83
Author: Dr. Lars Völker <lars.voelker@technica-engineering.de>
Date:   Wed Mar 13 10:31:25 2024 +0100

    SOME/IP: Improved robustness of UAT-based HFs (part 2)

    This patch also makes sure that the HFs are recalculated, when UAT reset
    CBs but not post_update CBs are called.

commit 276ec27478
Author: Dr. Lars Völker <lars.voelker@technica-engineering.de>
Date:   Tue Mar 12 14:50:22 2024 +0100

    SOME/IP: Improved robustness of UAT-based HFs

    Making sure that the dynamically generated HFs are regenerated on
    changed UATs or profile change, even though SOME/IP is not bound to any
    port.

    Closes: #19670

commit fbd1c1fdb6
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Aug 20 14:45:50 2024 +0000

    x75: clean up string handling, fix fuzzer warnings

    https://gitlab.com/wireshark/wireshark/-/issues/19384
    https://gitlab.com/wireshark/wireshark/-/merge_requests/12173#note_1595185911

    (cherry picked from commit d362623957885101c0482098b0b26afe04011634)

    Co-authored-by: Manawyrm <git@tbspace.de>

commit 3722bebbbe
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Aug 18 09:31:37 2024 +0000

    [Automatic update for 2024-08-18]

    Update manuf, services enterprise numbers, translations, and other items.

commit 4769eef1dc
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Aug 13 10:22:47 2024 -0700

    GitLab CI: Miscellaneous updates

    Disable the Documentation job, update our macOS image, and remove an
    unused job.

commit a13d9afd35
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu Jul 25 14:35:26 2024 -0700

    GitLab CI: Try to limit interruptibility to merge requests

    (cherry picked from commit 57af0553f10deb4727670a353e870ac24719c0ed)

commit 1174167024
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Dec 1 15:10:07 2023 -0800

    Test: Make sure sampleif.py uses our current Python executable

    Make sure sampleif.py uses the same Python executable as our test
    environment. Remove a related workaround from our GitLab CI config.

    (cherry picked from commit a7568772e75f2425f23ab065a2a5969efa8e87c9)

    Conflicts:
            .gitlab-ci.yml

commit 58a5ee8833
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Aug 12 14:50:51 2024 +0000

    profinet-mrp: Always subtract the OUI length

    The length for the OUI needs to be removed from the remaining length
    even in the unknown case.

    Really this whole function should be rewritten to pass in a subset tvb
    instead of a length, to minimize the chance of buffer issues.

    Fix #19986

    (cherry picked from commit f9e8483d1e2d864a0620a8dc5d9366a35da3619e)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit e8ceaf738e
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Aug 12 13:57:38 2024 +0000

    Qt: Don't idle dissect with the read lock held

    It's not a time when we're idle, and worse, it can
    lead to messages like:

    The capture file "bittorrent-comp_4.pcapng.lz4" appears to be damaged or corrupt.
    (pcapng: total block length 3722677760 is too large (> 134348832))"

    when saving a large file still doing idle dissection into a new
    format (new compression or new file type).

    (cherry picked from commit 8ab7f82f04b5bc651650c5d872debcb6371d6a6f)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit c4be26b956
Author: Niels Widger <niels@qacafe.com>
Date:   Tue Jul 9 20:04:06 2024 +0000

    Add nghttp3 support to RPM package

    Add nghttp3 support to the RPM package. If libnghttp3-devel is
    installed then it will be included.

    (cherry picked from commit 198dfd0450130090cbf18cea56fcd2936b23752c)

    Co-authored-by: Niels Widger <niels@qacafe.com>

commit e9dfb9398d
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Aug 11 09:31:11 2024 +0000

    [Automatic update for 2024-08-11]

    Update manuf, services enterprise numbers, translations, and other items.

    TLS CT Log IDs failed.

commit dbacf7e5df
Author: Tomasz Moń <desowin@gmail.com>
Date:   Sun Oct 15 19:25:14 2023 +0200

    USBLL: Call USB dissector after USBLL address is set

    Updating packet info with USBLL address after USB dissector set its own
    address breaks follow USB CDC stream functionality. Make reassembly the
    very last step to prevent address mismatches inside layers.

    (cherry picked from commit da7b7c81ded943cc283740ccd4531aa96a4394d9)

commit bca12d9793
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Aug 4 10:05:19 2024 +0000

    tools: Make some regex expressions raw strings

    Silence SyntaxWarnings like:

    ./tools/check_typed_item_calls.py:103: SyntaxWarning: invalid escape sequence '\s'
      self.p = re.compile('[^\n]*' +  self.fun_name + '\s*\(([a-zA-Z0-9_]+),\s*([a-zA-Z0-9_]+)')

    (cherry picked from commit 2a8b1973f8c511d3930b6e5767e785581251fcf4)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 307b8b5e94
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Aug 4 09:32:42 2024 +0000

    [Automatic update for 2024-08-04]

    Update manuf, services enterprise numbers, translations, and other items.

    TLS CT Log IDs failed.

commit e18fea7f46
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Aug 3 18:56:42 2024 +0000

    Qt: Stay in packet list history until we're done with history

    The functions that set in_history_ to true always set it to false
    when they're done. Sometimes selectionChanged gets called twice
    when in the middle of history (e.g., for clearing the selection
    as well), and this causes history navigation back multiple packets
    in history to cease to work.

    See 52955b9c43a99942b332a8a2c0c2995608a539a1

    (cherry picked from commit 9d2da2c45a94cdaf8ce17239057f6e33cc93c48b)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 283d547498
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu Aug 1 15:22:55 2024 -0700

    CBOR: Update a recursion check

    Fixes #19935

    (cherry picked from commit 30f11e96944434e17b9b2addf8ddf46d1bd8e2b8)

    Conflicts:
            epan/dissectors/packet-cbor.c

commit 6d943aac63
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Aug 1 21:29:10 2024 +0000

    packetBB: Skip over the extended type before retrieving length

    The packetBB TLV parsing parses the header twice, once to get
    the length in order to add the tree item with the correct length
    (rather than calling proto_item_set_len or similar later), and
    once actually adding the items. In the initial retrieval of the
    length it fails to increment the offset if the extended type is
    present according to the flags bit.

    Fix #19972

    (cherry picked from commit 18f6ca96d017ff0b7de6e2a5c27d76580af4adda)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 73ad17f2ff
Author: Markku Leiniö <markku@iki.fi>
Date:   Wed Jul 31 19:33:46 2024 +0300

    Zabbix: Add separate subtree identifier for Flags tree

    For release-4.2

commit d435ce949a
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Jul 31 18:15:25 2024 +0000

    BGP: fix check of length of labeled prefix

    Fixed display of default route for SAFI 4. The problem was in incorrect
    checking of the prefix length. The default route prefix length for this
    SAFI is 24 bits. This value was invalid.

    This was fixed for the SAFI 128, 129, 130. Also, RD accounting has been
    added to the prefix length check.

    (cherry picked from commit 133153238795ceaa18ae73786cd538dc9e2b5b12)

    Co-authored-by: Vitaliy Guschin <guschin108@gmail.com>

commit f7a0604894
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Jul 31 12:48:32 2024 +0000

    iee80211: Update status codes per 802.11-2020

    There was some confusion about the status codes because of an error
    in Draft P802.11Revmd which was clarified in the final published
    version.

    See b1ec5ddff6035bcc6c6eafae234f029e4871f123

    Fix #19955

    (cherry picked from commit ba07b59501b21e0d2cb44037980c5d465191f21f)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit ac47646727
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Jul 28 16:55:22 2024 +0000

    caneth: Initialize the other fields of the can_info

    The CAN-ETH protocol documents says that it is only for
    8 bytes of data, i.e. CAN_CLASSIC.

    This dissector wasn't updated when the bus_id field was introduced.
    Explicitly initialize it to zero.

    Fix #19627

    (cherry picked from commit b457e92c8232694515cfa085b503936068b39be4)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit be0e7c955d
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Jul 28 13:06:50 2024 +0000

    ntlmssp: Don't insert a key created on the stack into a hash table

    We could change this table to an autoreset wmem_map as well.

    Fix #19943

    (cherry picked from commit 66dcd56f1eae615697b6588ac4778a61a5576391)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 6efb2f5978
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jul 28 09:30:50 2024 +0000

    [Automatic update for 2024-07-28]

    Update manuf, services enterprise numbers, translations, and other items.

    TLS CT Log IDs failed.

commit d2f0853dc1
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jul 21 09:30:44 2024 +0000

    [Automatic update for 2024-07-21]

    Update manuf, services enterprise numbers, translations, and other items.

    TLS CT Log IDs failed.

commit 1049cb8c6e
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Jul 20 13:48:23 2024 +0000

    6LoWPAN: Fix base of Page Number field

    This is added with proto_tree_add_bits_item and as an integer (from
    4 bits), which means that the base needs to be an actual display
    base and not the width of a field (as used for FT_BOOLEAN fields
    with a nonzero bitmask, which is not when using add_bits_item).

    It happens to work because 16 is BASE_PT_SCTP, and the field happens
    to be FT_UINT16, which is compatible with a port type.

    Fix #19934

    (cherry picked from commit e9845bd3f91a9fb37e24dd50ffc7746964acca16)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit f2f322d2e0
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Jul 17 16:54:22 2024 -0700

    GitLab CI: Enable automatic pipeline cancellation

    Add a default job and make it interruptible. This should result in
    automatic pipeline cancellation when someone pushes new changes to a
    branch.

    (cherry picked from commit 7f96b474b8210bc54f1edbd901ae27fcc2d41ed7)

commit f958d76c6c
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Jul 16 16:15:08 2024 -0400

    lbmsrs: Do not throw exceptions in heuristics

    Subtracting two unsigned integers, and comparing them to a
    small number, is not a reliable way to see if enough bytes
    are left in the packet due to wraparound. To make things
    clearer, use the tvbuff API when we want to check if enough
    bytes remain.

    Noticed in the captures attached to #19921

    (backported from commit 5e17761308a7f6a504727758e75e67b3f370087a)

commit f14f0ae1c7
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Jul 16 17:31:47 2024 -0700

    GitLab CI: Fix an if statement

    [skip ci]

    (cherry picked from commit b23e9ac8ecfcfb68c6c1f97d1e45941ff07a3cd6)

commit a4c3c16c98
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Jul 14 16:44:42 2024 +0000

    [Automatic update for 2024-07-14]

    Update manuf, services enterprise numbers, translations, and other items.

    TLS CT Log IDs failed.

commit 0f599407be
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Jul 10 12:24:16 2024 -0700

    Version: 4.2.6 → 4.2.7

    [skip ci]
