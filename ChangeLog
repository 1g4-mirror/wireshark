commit 24645f52f5
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Oct 8 17:54:56 2024 -0700

    Build: 4.4.1

    [skip ci]

commit 9f33105c74
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Oct 9 11:53:13 2024 +0000

    RELOAD Framing: Call the matching wmem_free scope

    If we wmem_alloc in file scope, we have to wmem_free in file_scope
    instead of trying to call g_free on that address directly.

    Fixup 636ab9da8be8c6f653c8bac563e6506c16414a7c

    Fix #20116

    (cherry picked from commit 692f9bed05348166986b5219faefad43ccac522a)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 8c64eff1b8
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Oct 9 10:42:24 2024 +0000

    PortableApps: Add the Donation page

    The PortableApps Platform supports having a Donate page. Include ours.

    (cherry picked from commit 942134693498f67f18a23a880013061f2d43b73d)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit d17a2febc5
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Oct 8 18:19:22 2024 -0700

    RELOAD Framing: Make sure we have valid addresses

    Ping #20114

    (cherry picked from commit 636ab9da8be8c6f653c8bac563e6506c16414a7c)

commit 418fd5fe4b
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Oct 8 11:56:28 2024 -0700

    AppleTalk: Make sure we have valid addresses

    Make sure ATP, ZIP, and ASP have valid addresses. Use sizeof instead of
    a hard-coded value in a few places.

    Fixes #20114

    (cherry picked from commit 3de741321f85c205c0a8266c40f33cb0013bd1d2)

commit 016d325dd0
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Oct 8 09:28:09 2024 +0000

    Capture: don't retrieve both monitor mode and non monitor mode caps

    Don't always retrieve the capabilities for non monitor mode and
    monitor mode. It causes too many problems to put an interface into
    monitor mode when not requested, at least on macOS. Some of the
    related Linux issues (#20090 and #20100) were dealt with in another
    manner, because they would cause problems even when actually
    capturing in monitor mode.

    This can perhaps be revisited if libpcap can find a way to retrieve
    the link-layers supported when a device is in monitor-mode mode
    without actually putting the device in monitor mode.

    Fix #20051. Fix #20082.

    (cherry picked from commit cb83a64eef7ff63a26205541792913b89a618748)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 4ebe80cb25
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Oct 8 09:47:13 2024 +0000

    Qt: Allow saving files with Qt 6.8

    Prior to Qt 6.8, QFileDialog::selectedNameFilter() returns the current
    text displayed as the filter in the dialog; i.e., as we set
    HideNameFilterDetails it does not include the parenthetical extension
    list.

    As of 6.8, it includes the hidden details:
    https://bugreports.qt.io/browse/QTBUG-127924

    This causes hash lookups for the file type to fail, reporting
    unknown file type.
    One simple approach is just to add both to the hash.

    (cherry picked from commit 702116d425a1542c0db84e17236dae8c7e1b0bfd)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 63e35480e1
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Oct 7 10:29:31 2024 -0700

    Prep for 4.4.1

commit b8cc64ddb8
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Mon Oct 7 18:16:45 2024 +0000

    f5fileinfo: Update VELOS and rSeries platform identifiers

    Add missing platform identifiers for rSeries and VELOS platforms and VELOS
    blades.  Move the VELOS CX410 Chassis platform ID out of the '#if 0' block,
    since it will show up as the platform ID in a capture from that platform.

    https://my.f5.com/manage/s/article/K86001294
    - r5920-DF (C136)
    - r10920-DF (C137)
    - r12900-DS / r12800-DS / r12600-DS (C138)

    https://my.f5.com/manage/s/article/K4309
    - (VELOS) BX110 Blade (A118)
    - (VELOS) BX520 Blade (A119)
    - (VELOS) CX1610 (Chassis) (R100)

    (cherry picked from commit 8543274a5aa18eb108a31638f7f3195dcbfc4305)

    Co-authored-by: Paul Aurich <paul@darkrain42.org>

commit 67e4f7aa7c
Author: Giovanni Musto <giovanni.musto@partner.italdesign.it>
Date:   Mon Oct 7 05:50:08 2024 +0000

    BLF: Treat zlib's Z_STREAM_ERROR as WTAP_ERR_INTERNAL

    (cherry picked from commit f829d126978d4e7b1f24320bf70bc768cbddfc79)

    Co-authored-by: Giovanni Musto <giovanni.musto@partner.italdesign.it>

commit f9931f12b6
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sat Sep 28 08:02:21 2024 -0700

    GitLab CI: Ignore glab failures

    glab 1.41 and later return a nonzero exit code when the "auth" command
    fails.

    (cherry picked from commit d1f213208cdbe58fea8dbf418d3e1f00c5a7de6c)

commit f29fe5bde5
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Sep 27 10:27:45 2024 -0700

    GitLab CI: We don't need to install glab

    We install it in the ubuntu-dev container.

    (cherry picked from commit 7f9ebffbd678a4bdf4858b18e8b4b8d1d574a785)

commit 59997c88c9
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Sep 25 10:07:06 2024 -0700

    GitLab CI: Expand a comment

    Expand a comment about notes API permissions and print a message when a
    job doesn't have those permissions.

    (cherry picked from commit 082cd66ff3a92f0dfe07c3fae8ff0c9a6e882ee9)

commit 0d3b826933
Author: Chuck Craft <bubbasnmp@gmail.com>
Date:   Wed Sep 25 17:15:22 2024 +0000

    GitLab CI: Comment typo in .gitlab-ci.yml

    (cherry picked from commit f6c1d5423fc446ff2bfb8f6a12e3c54367dd477a)

commit 3a596892e7
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Oct 6 13:21:26 2024 -0700

    DMP: Add a length check

    Fixes #20110

    (cherry picked from commit 73422fb85976c4122a21fb72fe9b4bf711614abe)

commit eed95cbc58
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Oct 6 17:55:41 2024 +0000

    Don't try to use O_PATH when it's not available.

    The O_PATH flag is used in the DBus-based "Open in Folder" functionality on
    non-Windows non-Mac platforms.

    There exist non-Windows non-Mac platforms which support DBus and lack O_PATH,
    and the build would fail on those platforms.

    Fall back to using O_RDONLY instead of O_PATH when O_PATH is not available.
    This will require that read permission be granted for the file in question, but
    that should usually be the case.  As it is, this usage is only on a fallback
    path which should only be used when the application is sandboxed.

    Fixes #20031

    (cherry picked from commit 753f0077edf17fd7abe6f4f28995cd08920295c1)

    Co-authored-by: Darius Davis <darius-wireshark@free-range.com.au>

commit d0c54d2097
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Oct 6 17:56:41 2024 +0000

    capture: Disable interface monitor on Linux when getting caps

    Changing the monitor mode settings of a device can create and/or
    remove a temporary device under Linux. We don't want retrieving
    the capabilities of an interface to trigger new interface list
    refreshes, which lead to an infinite loop. That includes when
    starting stats. For similar reasons, stop listening immediately
    when beginning a capture.

    Do this by telling the socket to stop listening for messages
    temporarily while the retrieval is in progress. Actually removing
    the socket would require more updates in the GUI; if we told the
    GUI to stop processing we would have to wait to start listening
    again when the event loop had processes all pending events on
    the file descriptor.

    Fix #20100. Fix #20090.

    (cherry picked from commit 5e958a30599bf42df5172c91274a69656acd9483)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 77e5b70cb9
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Oct 6 09:32:09 2024 +0000

    [Automatic update for 2024-10-06]

    Update manuf, services enterprise numbers, translations, and other items.

commit 5933e848a2
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Oct 4 13:33:46 2024 -0700

    gen-bugnote: Fix an escape

    We're using jq's --raw-output, so we need to escape backslashes.

    (cherry picked from commit ccea80520a88b8c7f757c24409677948c3b569d8)

commit 6b2f465976
Author: Guy Harris <gharris@sonic.net>
Date:   Sat Oct 5 00:44:32 2024 +0000

    BLF: Replace ws_strdup_printf with ws_strdup where it makes sense

    (cherry picked from commit 33ffdeaaf9d41f5d5443f5d7c46f70d6824f9311)

    Co-authored-by: Giovanni Musto <giovanni.musto@partner.italdesign.it>

commit 9504aec601
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Oct 4 23:56:46 2024 +0000

    BLF: Skip over corrupted log containers with a warning

    (cherry picked from commit ca8f21ef2f8a77020a51290dd92799b3ee66d95b)

    Co-authored-by: Giovanni Musto <giovanni.musto@partner.italdesign.it>

commit 2f021b1a5d
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Oct 4 14:55:55 2024 -0700

    Update enums.

commit fe5889e196
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Oct 4 22:14:17 2024 +0000

    wslua: fix indentation. [skip ci]

    (cherry picked from commit 71267bd42ffc26eaec78efe121d0c55603a32b84)

    Co-authored-by: Guy Harris <gharris@sonic.net>

commit 1f5931e311
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Oct 4 19:47:53 2024 +0000

    BLF: Make sure we return if we fail to allocate memory

    (cherry picked from commit 301a7ea03e201e6d8e11e72e872ea3d6fd8a9fbb)

    Co-authored-by: Giovanni Musto <giovanni.musto@partner.italdesign.it>

commit 21d51bd022
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Fri Oct 4 19:16:17 2024 +0000

    Art-Net: Update OEM and ESTA codes

    (cherry picked from commit 3754aba2d621736f18eee3e2541cb8cdaa3ad27c)

    Co-authored-by: Martin Mayer <martin.mayer@m2-it-solutions.de>

commit 6bcddf6e2f
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Fri Oct 4 15:39:55 2024 +0000

    OWAMP: Support PTP timestamps (RFC 8186)

    RFC 8186 added optional support for truncated PTP format timestamps
    to OWAMP as well as TWAMP.

    (cherry picked from commit c7bdedc30c27c78de7441b10aadb107b3277183f)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit e3aad590a7
Author: John Thacker <johnthacker@gmail.com>
Date:   Fri Oct 4 09:52:28 2024 +0000

    TWAMP: Fix sender timestamp format (Z-bit, RFC 8186)

    The Z-bit being 1 indicates truncated PTP time format according to
    RFC 8186. Zero (as it must be prior to that) indicates NTP time format.
    The handling was reversed for one of the three cases.

    (cherry picked from commit d69138d8f2eab3a4b2063fb9e96dbf31b32b9288)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit bbf0f30288
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Oct 2 11:06:45 2024 +0000

    Qt: Don't refresh interfaces while capturing

    If we get a request to refresh interfaces while capturing is
    going, defer it until we're not longer capturing and process
    the interface list then. Changing the interface list during a
    capture isn't something we can really do much about; if we're
    capturing on a single interface and it goes away, that will stop
    capturing, at which point the interface list will be taken care
    of.

    Note that 89cc85b5efce579aeda3cfaeb0d74551b229acc4 in fixing #11176
    for similar reasons disabled the menu item, so this is only from
    interacing monitoring.

    This prevents, among other things, the extcaps from being rediscovered
    and their toolbars from being cleared. Fix #19854.

    It also fixes some problems that occur when capturing on a device in
    monitor mode.

    (cherry picked from commit 192499b9afa52f9e4e6609502ddef698c4b94ee5)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 8e9aaab786
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Oct 2 01:15:00 2024 +0000

    MMS: Add more null checks

    Also don't register the protocol in tables a second time. We don't
    need to call the handoff function when changing the preferences
    because there's nothing it needs to do.

    The files in #1342 crash when disabling the new preference without
    checking if the private data is null.

    (cherry picked from commit 906e55b8d588171d1995224a7cc012c2a13f3a21)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 3460778bf4
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Sep 26 20:28:05 2024 -0400

    tshark: Change fields glossary report with prefix syntax

    Backport part of the glossary report changes from the master branch.
    Adding the prefix as an extra option separated by a space made
    other options, like the configuration profile setting, not work.
    Change the syntax to "-G fields,<prefix>", similar to the "-z"
    options and as done in the master branch.

    Among other things, this makes it easier for people to list the
    fields corresponding to columns. (See #20096.)

commit 783600a46c
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Sep 30 23:47:33 2024 +0000

    NSIS+WiX: Switch back to "release-notes.html"

    668881fec7 and 487b336942 installed the release notes as "Release
    Notes.html". This broke the help URL code, so switch it back.

    Fixes #20056

    (cherry picked from commit a813b0ed6d1294d1322020e9d9323e1ea567f161)

    Co-authored-by: Gerald Combs <gerald@wireshark.org>

commit a647c39eb8
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sun Sep 29 17:30:19 2024 +0000

    gsm_sim: Add EF.ARR and EF.UMPC

    Added EF.ARR (2F06) and EF.UMPC (2F08), and fixed EF.PL (2F05).

    (cherry picked from commit c5b5c881145641e9830657895282bfc8bb0f6b5c)

    Co-authored-by: Stig Bjørlykke <stig@bjorlykke.org>

commit 4b1d99dae0
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 29 09:32:19 2024 +0000

    [Automatic update for 2024-09-29]

    Update manuf, services enterprise numbers, translations, and other items.

commit e3a320cc67
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Sep 29 01:39:17 2024 +0000

    MySQL: Handle embedded null bytes in queries

    The MySQL/MariaDB protocol states that COM_QUERY and COM_STMT_PREPARE
    use string<EOF> (to the end of the packet) to contain SQL queries,
    because embedded NUL bytes are allowed:

    https://dev.mysql.com/doc/dev/mysql-server/latest/page_protocol_com_query.html
    https://dev.mysql.com/doc/dev/mysql-server/latest/page_protocol_com_stmt_prepare.html
    https://mariadb.com/kb/en/com_query/
    https://mariadb.com/kb/en/com_stmt_prepare/

    Fix the MySQL-specific parts of #20101.

    There's a separate issue affecting all of Wireshark involving proper
    display and handling of string fields with embedded NULs.

    (cherry picked from commit 67d99398798ca320fb7d7324f47aa24199ef8860)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 054a3ce224
Author: Guy Harris <gharris@sonic.net>
Date:   Thu Sep 26 23:24:00 2024 -0700

    mysql: don't just skip over data, check that it exists.

    This ensures that a too-large length (including one with the uppermost
    bit set, so that, if cast to an int, it becomes a negative number) will
    cause an exception, rather than causing the packet offset to overflow or
    underflow.

    (backported from commit 7613e20cc708d0f653ffd6e378fa0c6ffb0afb2d)

commit 3e180bab83
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Sep 24 09:26:23 2024 -0700

    WiX: Fix some component names

    (cherry picked from commit 6c84326487555f9a437dff5a6688ef4827779031)

commit a01f4ace45
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 23 16:31:59 2024 -0700

    wsutil: Remove an unnecessary component from the Windows extcap path

    !14774 / 8541041922 ensured that we have separate namespaces everywhere
    for syscall+log and packet extcaps. It went a bit too far and added an
    unnecessary subdirectory to the global extcap path on Windows.

    Add missing "running in build directory" logic on Windows and use it
    to build the proper extcap paths for both the build and installation
    directories.

    Fixes #20069

    (cherry picked from commit a616eb00d1369cba8d42950ec3620a8490e7fe06)

commit 95bc8b9a9b
Author: Anders Broman <a.broman58@gmail.com>
Date:   Wed Sep 25 14:06:07 2024 +0000

    file_wrappers: Cast size_t to unsigned for MSVC

    For other reasons, we limit our buffer size to unsigned. The
    LZ4 functions need a pointer to a size_t. Cast the size_t
    result back to a unsigned when adjusting the buffer size so
    that MSVC is happy. (This is guaranteed not to overflow.)

    Ping #20094

    (cherry picked from commit 88b46e6ea8571695613bf49f6614f879bfd86e8e)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit d8873f8ab1
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 25 12:56:38 2024 +0000

    CMake: Re-enable /W2 for MSVC

    The various warnings that /W2 gives have been dealt with, so we
    can re-enable this level. Eventually we want to re-enable /W3
    instead, but there's a few more to handle. In the meantime,
    prevent extra /W2 level warnings from entering the code.

    Ping #20094

    (cherry picked from commit 68cab315a0e8f4418de04a37427d75d43c2f3dc3)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit d4bd213507
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 25 12:31:12 2024 +0000

    CMake: Only disable warning C4100 for Lemon files on MSVC

    Our Lemon generated code usually has unused parameters, which
    we warn about, which become errors thanks to -Werror or /Wx.

    Disable just that one warning. On MSVC, that means disabling
    compiler warning C4100, instead of eliminating all warnings.
    This has the advantage of avoiding command line warning D9025
    for overriding our other warning level flags with '/w'.
    (Actually removing an existing flag using CMake, as opposed to
    overriding it with a later flag, is quite annoying.)

    Ping #20094

    (cherry picked from commit 7993b6836c09f20e7c117672582399bb327a8711)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit adeba83d70
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 25 11:31:56 2024 +0000

    wslua: Use a 64 bit function for masks

    Don't use a function that does a cast to a 32 bit function as
    an intermediate step if we want a 64 bit output.

    Note that, we need to go back and fix all these casting functions
    so that they handle it better when lua_Integer is 64 bit (but never
    unsigned, though at some point casting from unsigned to signed will
    be officially ok now that C++20 and C23 have decreed that numbers
    must be two's complement.) Though users who worry about that should
    use our Uint64 type anyway.

    Ping #20094

    (cherry picked from commit adcbc0944e5baef84d38b225e418619548693230)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 73651fa00c
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 25 11:13:07 2024 +0000

    RTCP: Explicitly cast to float for MSVC

    Ping #20094

    (cherry picked from commit ebfda40074563d951c0caf403902a6dfc1203275)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 9d688965d5
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 25 00:26:55 2024 +0000

    I/O Graph: Explicitly convert from uint64_t to double

    MSVC on /W2 or higher will warn about the loss of precision, but
    QCustomPlot only plots doubles so we don't care.

    This commit is split into two parts; this part needs to be
    cherry-picked to 4.4, the other one doesn't.

    Ping #20094

    (cherry picked from commit 0c681181e4f60ec2b9c401bd1c01d01382b12f79)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 66df97f526
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Sep 24 23:57:20 2024 +0000

    lua: Don't convert to double (lua_Number) and back

    The various wtap_file_type... C functions all return ints.
    Assign the return value to lua_Integer before using lua_pushinteger,
    instead of having an intermediate step converting to a lua_Number
    (almost surely a double and back.)

    MSVC, at /W2 or higher, will complain about these. Ping #20094.

    (cherry picked from commit 67e3dbdffd9dca10d3569b0d44e6f87e8e399c81)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit c192ece9d6
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Sep 23 00:01:07 2024 +0000

    capture: Check if g_malloc fails

    g_malloc is supposed to terminate the program upon failure, but at
    least some versions of gcc don't think that happens, at least when
    Release build optimizations are turned on.

    Fix #19930

    (cherry picked from commit c02d0066b5e16d575f5a606b84246fd8b0349d6e)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 5106f67635
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 22 09:31:33 2024 +0000

    [Automatic update for 2024-09-22]

    Update manuf, services enterprise numbers, translations, and other items.

commit 91cb90467b
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Fri Sep 20 15:18:16 2024 +0000

    qnet6: Properly handle bitmask to string conversion (CID 1559832)

    (cherry picked from commit 4fc25c071a6e1983a758f12c813611e63f5f6e8e)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 8b37beda0a
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Sep 19 14:49:20 2024 +0000

    GOOSE: Set the length

    GOOSE is carried within Ethernet, so call set_actual_length so that
    the Ethernet dissector can have a chance to detect FCS, trailer, etc.

    Fix #20088

    (cherry picked from commit 06b9906812997c17598642a462d1f811347cefaa)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit d06031438f
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Sep 19 14:23:41 2024 +0000

    extcap: Fix reapplying commandline args fix

    Don't use the (probably no longer valid) global ws_optarg when
    reapplying the commandline arguments.

    Fixup b68a80ef4d4f01210c51c24d2a7efa1f8e030046

    (cherry picked from commit 56b920d28e33e5ecd790b31783db62202e73e208)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit cbbc372c40
Author: Anders Broman <a.broman58@gmail.com>
Date:   Thu Sep 19 05:50:58 2024 +0000

    Qt: RTP Player silent crash if codec not loaded

    Playing amr file before !17335 crashed when skipSilenceButton clicked.

    (cherry picked from commit f346de0f88ea651f113027c48c458e02c14f12b5)

    Co-authored-by: Chuck Craft <bubbasnmp@gmail.com>

commit b0802f3665
Author: Chuck Craft <bubbasnmp@gmail.com>
Date:   Wed Sep 18 21:19:42 2024 +0000

    Qt: if copying null field let user know

    (cherry picked from commit f61931a1649a461b612f20a16e1c8cb998fff0f0)

    Co-authored-by: Chuck Craft <bubbasnmp@gmail.com>

commit 4967b50bf2
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 18 19:36:56 2024 +0000

    NSIS+WiX: Add the amrnb plugin

    Install the amrnb plugin on Windows.

    Commit 969b71674075258ab6d0b40d134047cc6ebdddf2 added the OpenCORE
    AMR-NB codec, but it needs to be installed.

    (cherry picked from commit 16e2df793f3519c7537b1a2303c6fd01b72b408b)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 65ccb7ec58
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 18 11:59:38 2024 +0000

    tshark: Fix --global-profiles directory

    get_global_profiles_dir appends PROFILES_DIR to get_datafile_dir.
    Using it as the persconffile_dir means that when configuration
    profiles are searched for, there's an extra PROFILES_DIR appended
    (as it is unecessarily appended for the NULL/Default profile, and
    gets appended a second time for other profiles.)

    Just set it to the value of get_datafile_dir (which will then
    make the personal configuration directory the same as the global
    one.)

    (cherry picked from commit f0fbf9d0b5cb9316643181188292f6a8f2f13e4c)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 4736dd23d0
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Mon Sep 16 17:39:28 2024 +0000

    HTTP: Check strstr() returns before dereferencing them (CID 1596644)

    Also don't mark a used function parameter as unused.

    (cherry picked from commit e5adf89f95f28266d41bc195378d0567273047de)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 272dbaf79b
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Mon Sep 16 17:39:59 2024 +0000

    IRDMA: Make sure the end point data is actually there (CID 1596732)

    Some much of the underlying code depends on epd being valid that
    this warrants a DISSECTOR_ASSERT.

    (cherry picked from commit ca6232532e646ecc66c72868b697d629480faa62)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 620d99d2e5
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Mon Sep 16 17:40:17 2024 +0000

    CLLOG: Handle non-nl terminated files properly (CID 1592971)

    (cherry picked from commit f95acdd9ce9161c1668ddff4473a7b139f4490c5)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit f35d8c1959
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Mon Sep 16 17:40:42 2024 +0000

    CLLOG: handle non-nl terminated empty file (just header) (CID 1592970)

    (cherry picked from commit 69782792f83545571b2c3635d2284f8be4720a0e)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit eec19c3169
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Sep 17 13:43:52 2024 +0000

    CoAP, Thread: Do not hijack application/octet-stream for Thread

    Over CoAP, "application/octet-stream" (usually?, always?) means
    Thread. Outside of CoAP, that's far from a given, as its official
    registration is "arbitrary binary data".

    Undo part of 69c9e06daea490479abc96d2f586411b814d7660

    Also see 8724c249e1cd2a91e726a682d85924a58ae10b18

    Fix #14729 again.

    (cherry picked from commit aa0f85203a697a479de62df5e8621c792de64bdb)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit f7d8095771
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Sep 16 11:48:02 2024 +0000

    Qt: Set maximum capture size when first opening dialog

    The various currentIndexChanged signals don't get sent for the
    initial value (or if the index is programmatically set to the
    current value.)

    Fix #20079

    (cherry picked from commit bda33418a0befcd9478a3d320dda7fffa9061f20)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 23906ffe71
Author: Anders Broman <a.broman58@gmail.com>
Date:   Mon Sep 16 06:52:16 2024 +0000

    Thrift: Fix fallback when subdissector fails

    - Ensure all sub-dissector errors use THRIFT_SUBDISSECTOR_ERROR instead
      of THRIFT_REQUEST_REASSEMBLY to effectively fallback.
    - Reset proto_depth before fallback on generic dissector.

    (cherry picked from commit 7ae1be7acb46e65140271f824b0b6808911e7561)

    Co-authored-by: Triton Circonflexe <triton@kumal.info>

commit 58901982da
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 15 09:32:11 2024 +0000

    [Automatic update for 2024-09-15]

    Update manuf, services enterprise numbers, translations, and other items.

commit da3daae879
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Sep 14 01:41:58 2024 +0000

    http2: Store the correct length of header values in the case of errors

    UTF-8 validation can change the length of a string due to replacement
    characters.

    Fix #20071.

    (cherry picked from commit 0d43eaa186b2eea90e5886b3d7e0489a839bba7d)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit ff428af206
Author: Anders Broman <a.broman58@gmail.com>
Date:   Thu Sep 12 10:32:23 2024 +0000

    COSE: fix media_type registration and dissection

    (cherry picked from commit c77348274c46eb788525dc960d1c193e5f5a5d3c)

    Co-authored-by: Brian Sipos <brian.sipos@jhuapl.edu>

commit 79b1bdffa0
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Wed Sep 11 18:57:46 2024 +0000

    gsm_a_gm: Fix a plural issue

    Show correct unit for 1 hour.
    Add some whitespace to the switch-case to improve code readability.

    (cherry picked from commit 10fa5e9a0c0929191d011ec1f5a0e64533e8bf7e)

    Co-authored-by: Stig Bjørlykke <stig@bjorlykke.org>

commit 6db7b560fb
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 15:13:56 2024 +0000

    CIGI: remove duplicate packet_id comparison (cid 1587067)

    (cherry picked from commit c39558a94a346917761bb47e806216398546bae3)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 8380c8778b
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 15:14:22 2024 +0000

    SANE: explicitly ignore return values, checked elsewhere (cid 1587014)

    (cherry picked from commit 30a16e2ac70448b6b3244c7533e1d44a0079695c)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 110f900a50
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:45:50 2024 +0000

    distcc: remove function exit, thereby reviving dead code (cid 1604179)

    (cherry picked from commit 004af4220b0f1d5afbab61fe60089bfc06f051f4)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 610994619e
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:50:13 2024 +0000

    SMB2: Initialize policy_hnd in case of malformed packet (cid 1591793)

    (cherry picked from commit 0bd0256112716e41f125f685433538eb469e4209)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 2d026eb329
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:48:52 2024 +0000

    ippusb: always restore save_fragmented to pinfo (cid 1595719)

    (cherry picked from commit 363df914cfa311d6338b6146aedb6a21586bd331)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit daa3428bd4
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:48:15 2024 +0000

    Qt: add missing initializers to FunnelAction class members (cid 1595995)

    (cherry picked from commit d11558025d187081c5c50263d05e3612a5e99f80)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit f74476ae51
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:47:14 2024 +0000

    Qt: drop unused class member from ProfileSwitcher (cid 1596173)

    (cherry picked from commit 456450796c35933ad0c4ed6e7b3af03b792c110a)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit e1a821b0e9
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:46:27 2024 +0000

    Qt: free df_translators no matter what (cid 1598397)

    (cherry picked from commit 4a29ea0c0e9ede184ecfc507a1fcb2b4ff4de493)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 9f1a67db25
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:49:27 2024 +0000

    EPAN: check format prefs retrieved before dereference (cid 1592165)

    (cherry picked from commit 9cfbf5ee25b1d694fba6ebacf06b8cb927b614a8)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 93d62cf6f2
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 10:50:57 2024 +0000

    Qt: Always check the returned dataModel (cid 1591759)

    (cherry picked from commit 94d366bbe0dce09fe83cf615841b21378df8d6a2)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 93f0c634a1
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:44:50 2024 +0000

    GIOP: make length check not roll over (cid 1604271)

    (cherry picked from commit c5be8b945e319c1fc4f55dea9ff1b2388614a358)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 8a6fc0ebe5
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:44:02 2024 +0000

    sysdig-event: use unsigned type for encoding (cid 1604277)

    (cherry picked from commit f91b08fddf818ab94b128362643609d21d260eee)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 1562deb945
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:43:23 2024 +0000

    RTLS: properly handle header and signature length (cid 1604278)

    First off make sure the message contains both header and signature
    amount of bytes.
    Then make sure to take the signature into account when confronted
    with an unknown message type.

    (cherry picked from commit 9aeffc68eb7aa0b7e2fb378ba9ba002cc0408648)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit d5db52b16b
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:42:33 2024 +0000

    cipmotion: Use proper unsigned arithmetic (CID 1604280)

    (cherry picked from commit c7a2c9fea05485847db2bba8c1ed9b195a8a30e1)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 81f8cc853e
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:41:58 2024 +0000

    MQ: Use unsigned type for encoding (cid 1604285)

    Correctly pass along ENC_LITTLE_ENDIAN as unsigned value.

    (cherry picked from commit 515d93034126291555fb491cc877d7fb2a78fb59)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 52d624bce2
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:40:49 2024 +0000

    IDN: use correct type for data_size (cid 1604286)

    In function dissect_idn_dmx_data() all use of data_size is based on
    the 'int' type. Define it as such, rather than uint16_t.

    (cherry picked from commit 9c0d6991ba5a2bef9218e2414f8292fba4b52e64)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit ca786094ac
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:40:06 2024 +0000

    NCP-SSS: handle invalid strings properly (cid 1604295)

    Packets that contain invalid strings, i.e. string with first
    character being a \0 cause index overflow. Do not rely on overflow
    behavior, but increment buffer overflow only on stored characters.

    (cherry picked from commit c8e16a83616c1affa18a8f174ccbdd8ba64e2f89)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit b7b74d72b0
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Sep 11 06:38:31 2024 +0000

    Qt: missing class member initialization (CID1596731)

    (cherry picked from commit 7185e3c6675ee83d6a9ed59e23c026d75c47d36d)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 1e76da8d14
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Tue Sep 10 15:05:32 2024 +0000

    gsm_a_gm: Use hours as unit

    Change from "hr" to "hours" as units for GPRS Timer 3.

    (cherry picked from commit eb86ba533a89782c55149171676d8f53878a8ee4)

    Co-authored-by: Stig Bjørlykke <stig@bjorlykke.org>

commit 53fbcc7645
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Sep 10 18:24:18 2024 +0000

    filesystem: Only remove namespace from progfile_dir for extcaps

    Extcaps are in their own subdirectory, so trim_progfile_dir trims that
    off in that case to return the common program file directory.
    Extcaps are now in a namespaced subdirectory, so we trim that off first
    before looking to see if the next directory name matches "extcap".

    However, if it's not an extcap directory, then restore the supposed
    namespaced subdirectory. It could be "wireshark" from some other path,
    particularly from \Program Files\wireshark (which, since Win32
    GetModuleFileName doesn't "correct" the case of paths passed in on
    the command line, can also happen if Wireshark is installed to the
    default location.)

    Fix #20057

    (cherry picked from commit 14831b9fe210c112754b3b487def49a94ff4462c)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit d53d2995b5
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Sep 10 18:02:45 2024 +0000

    extcap: Ensure command line options are applied

    We have to read the preference files and the command line options
    before loading the extcaps so that we can see the state of the
    capture.no_extcap preference and avoid the (possibly time-consuming)
    loading of the extcaps if the user has asked us not to do so.

    However, after loading the extcaps, we have to make sure that any
    extcap options given on the command line are actually applied.

    Fix #20054

    (cherry picked from commit b68a80ef4d4f01210c51c24d2a7efa1f8e030046)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit f4d0b0d4f9
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Sep 9 23:37:22 2024 +0000

    filesystem: Work around CMake absolute paths

    CMake recommends that the various CMAKE_INSTALL_<dir> variables
    be relative paths, and we have been assuming that they are.
    Absolute paths are technically allowed.

    Work around absolute paths, and just don't look for the doc
    dir, etc. in relocated paths if they are.

    Fix #20055

    (cherry picked from commit 1dcf5f01b5ddf5b8c288557a0d727145ff618841)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit e4cbf3dae6
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Sun Sep 8 16:22:42 2024 +0000

    Wiretap: Fix CLog err_info handling (CID 161877)

    Pass the correct pointer to be freed.

    (cherry picked from commit d12fe0c637a59775e243e4880b217e67a7379d1b)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit 5deb4ec1b9
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 8 09:32:26 2024 +0000

    [Automatic update for 2024-09-08]

    Update manuf, services enterprise numbers, translations, and other items.

commit 9e910c71e3
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Sun Sep 8 06:17:55 2024 +0000

    epan: Use nstime_cmp in frame_data_set_before_dissect

    Use the comparison function rather than checking the members of
    nstime_t directly. This also eliminates a case of a time_t to
    a 32 bit integer, Coverity CID 1509330

    (cherry picked from commit a82f254f27d612f33410b6628379d58da876b38b)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 7332f2e22b
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Sep 7 00:46:02 2024 +0000

    Qt: Set the DisplayFilterExpression dialog parent in child windows

    If the DisplayFilterExpresion window is being launched from a
    DisplayFilterEdit in a window other than the main window (and thus
    other than from the main DisplayFilterCombo), set the new window
    to be WindowModal. This also (after 67daaa34213bb10d493fcf88dfc21)
    properly sets the parent relationship.

    At a minimum, properly setting the parent widget is necessary in order
    for the DFE window to be usable if the spawning window is modal;
    otherwise, the parentless DFE is unusuable while the modal window
    (which has the line edit intended to hold the DFE result) is open.

    Fix #20049

    (cherry picked from commit 81126d8584fbec1d693c2b6e0c373e0132ad14d8)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit e779fa21da
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Sep 6 23:42:34 2024 +0000

    BLF: Validate date and time

    (cherry picked from commit d9269fb2f64d38f9affd84be0a26ea8e3378545e)

    Co-authored-by: Giovanni Musto <giovanni.musto@partner.italdesign.it>

commit 9f920560a3
Author: Anders Broman <a.broman58@gmail.com>
Date:   Fri Sep 6 20:07:19 2024 +0000

    TECMP: Pass only payload to data type subdissector (BUGFIX)

    This patch only passes the payload instead headers, payload, and all
    following payloads.

    Also the data_flags are passed via data.

    Closes #20052

    (cherry picked from commit b5e869aaaa2c6cd25f9163f6e4b5ea56c2d18289)

    Co-authored-by: Dr. Lars Völker <lars.voelker@technica-engineering.de>

commit 81967b5603
Author: Anders Broman <a.broman58@gmail.com>
Date:   Fri Sep 6 10:36:15 2024 +0000

    TECMP: Add support for Raw Ethernet

    This patch adds support for Raw Ethernet data. This means Ethernet
    recording including preamble and SFD.

    (cherry picked from commit c8f60142721a25ac94b0e840f06d43421d731a86)

    Co-authored-by: Dr. Lars Völker <lars.voelker@technica-engineering.de>

commit 30b049d8fd
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Thu Sep 5 19:53:18 2024 +0000

    html2text: add handling of <sup> tag, for use as exponent

    This HTML:   up to 2<sup>25</sup> (33 million) items
    Converts to  up to 2^25 (33 million) items

    Fixes #20020

    (cherry picked from commit 2bc85a90d3c9431e13f578a11eaaa795651e4b2a)

    Co-authored-by: Jaap Keuter <jaap.keuter@xs4all.nl>

commit b71dcce8d2
Author: Anders Broman <a.broman58@gmail.com>
Date:   Thu Sep 5 06:49:51 2024 +0000

    id3v2: fix conflict about id3v2.undecoded filter

    (cherry picked from commit 45453e2582e3af32321ea84ad78aa5a4505d591c)

    Co-authored-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit f087c1e0ea
Author: Anders Broman <a.broman58@gmail.com>
Date:   Thu Sep 5 06:48:35 2024 +0000

    id3v2: fix conflict about id3v2 display filter

    (cherry picked from commit f8c37e40b37bf279b9f7bac4856284f6710c6649)

    Co-authored-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit 0eb7dc102a
Author: Anders Broman <a.broman58@gmail.com>
Date:   Thu Sep 5 06:00:26 2024 +0000

    btl2cap: Correct length of Connectionless Data Channel PDU (G-Frame)

    As 3.2 CONNECTIONLESS DATA CHANNEL IN BASIC L2CAP MODE of the
    Bluetooth Core Specification says, "For G-frames, the PDU Length equals
    the payload size plus the number of octets in the PSM."

    Subtract the PSM length before creating a next PDU or adding to the
    tree as fallback data.

    Fix #20047

    (cherry picked from commit 8c77ef66c42b472d9e1addc9350e6d42225b8d19)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit abe64a4d9c
Author: Anders Broman <a.broman58@gmail.com>
Date:   Thu Sep 5 05:28:58 2024 +0000

    asn2wrs: Handle NamedNumbers in ValueRange constraints

    ITS uses NamedNumbers from the NamedNumberList of the parent
    type in PER-visible ValueRange constraints. Handle that by
    passing in the appropriate NamedNumberList from the Type
    (or parent type of a Type_Ref) when calculating the values of
    a ValueRange constraint.

    (cherry picked from commit 171e202e25f365a25ba0add57d6e9c9f671eea2a)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit a21dc29e79
Author: Anders Broman <a.broman58@gmail.com>
Date:   Wed Sep 4 20:29:06 2024 +0000

    asn2wrs: Create types for type refs with extra value constraints in PER

    In PER (and OER) additional value constraints can change the size on
    the element in a similar way to size constraints. Add constrained
    types when value constraints are added.

    If a subtype (Type_Ref) has a value constraint and is an integer
    type in PER or OER, use the min and max values from the ValueRange
    of the subtype instead of the original type.

    Remove some conformance lines that are no longer needed.

    Add a conformance line for one still unhandled case, where the
    ValueRange constraint is given using names from the NamedNumberList
    of the base type.

    Fix #19886

    (cherry picked from commit a21bada17650ea2e5d7f51fecfdeaec3db1bfe51)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit aa884950ee
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 22:11:56 2024 +0000

    asn2wrs: Don't add an ignored constraint to a UNION

    If there are UNIONS involving constraint types we currently ignore,
    e.g. WITH COMPONENT[S], don't create a union involving a None, just
    collapse into the other operand.

    Related to #19886, #19368

    (cherry picked from commit dc6ff72a0c3174c43a496befa77069ea62cd9ab0)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 81b2647233
Author: Anders Broman <a.broman58@gmail.com>
Date:   Wed Sep 4 15:47:41 2024 +0000

    Resources: Make our .pc file static again

    Partially revert 107550c9c0 and make the pkgconfig prefix static.

    (cherry picked from commit a9d17a13afa15c7ffe5afc6db817208bc2887a13)

    Co-authored-by: Gerald Combs <gerald@wireshark.org>

commit d7d429014b
Author: Dr. Lars Völker <lars.voelker@technica-engineering.de>
Date:   Wed Sep 4 21:15:17 2024 +0200

    TECMP: Add missing ILaS Commands (BUGFIX)

    Fixing the ILaS Command Table by adding missing commands.

    (cherry picked from commit 042a7a3d0a78f9b1cfcd13a9db562617cb58403d)

commit 8bb3378fac
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 12:54:06 2024 +0000

    BGP: fix value_string conflict/duplicate entry/typo

    (cherry picked from commit 44268d4eabba0078d8f539cd89c3a3da1819bb0d)

    Co-authored-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit 0282e4c9a6
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 11:52:56 2024 +0000

    OER: Account for extension bit in presence bitmap in offset

    When advancing the offset of a sequence type on OER after the presence
    bitmaps, consider the extension bit as well. Use the bit_offset value
    instead of the number of options present.

    Fix #20044

    (cherry picked from commit 91a20c2351fb8c08d77816abfeee7da50d13191b)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit fa3e49548f
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 10:56:37 2024 +0000

    Fix wrong bitmask for OM control field

    (cherry picked from commit d6690eee73e209c5616a0cd044cf030186f7e5de)

    Co-authored-by: WFA-achuang <achuang@wi-fi.org>

commit 22f130c2c6
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 09:29:48 2024 +0000

    Qt: Find Packet placeholder text is only for display filter

    Fix up !16440

    (cherry picked from commit 15f854f70f7ede94c81025784f08c4844258f0d3)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 3ec22ea40c
Author: Anders Broman <a.broman58@gmail.com>
Date:   Wed Sep 4 10:03:57 2024 +0000

    ITS: Fix ObjectDimensionConfidence special value formatting

    ObjectDimensionConfidence uses 32 as Unavailable and 31 as outOfRange:

     * The value shall be set to:
     * - `n` (`n > 0` and `n < 31`) if the confidence value is equal to or less than n x 0,1 metre, and more than (n-1) x 0,1 metre,
     * - `31` if the confidence value is out of range i.e. greater than 3,0 m,
     * - `32` if the confidence value is unavailable.

    The 102 and 101 numbers were accidentally copied from
    AccelerationConfidence:

     * The value shall be set to:
     * - `n` (`n > 0` and `n < 101`) if the confidence value is equal to or less than n x 0,1 m/s^2, and greater than (n-1) x 0,1 m/s^2,
     * - `101` if the confidence value is out of range i.e. greater than 10 m/s^2,
     * - `102` if the confidence value is unavailable.ProtocolVersion

    Ping #19886

    (cherry picked from commit 91bfbf22a019b89e6f25e9d48773c6f81b07ccc6)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 733544bb66
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 09:31:14 2024 +0000

    ITS: Add private data, INFO column for CPMv1

    Fixup 06faabf9cc9c954e5a3044278d5b14b1e934ac61

    Fix #20026

    (cherry picked from commit 6d22bfced65550f371713821da8830d0e7333b11)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 2ff525aa4b
Author: Anders Broman <a.broman58@gmail.com>
Date:   Wed Sep 4 09:04:33 2024 +0000

    ITS: Restore dissection of CPM v1

    (cherry picked from commit 06faabf9cc9c954e5a3044278d5b14b1e934ac61)

    Co-authored-by: Anders Broman <a.broman58@gmail.com>

commit 36317deb41
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Sep 4 00:20:48 2024 +0000

    Netflow(v8): fix dissection of ToS AS/Prefix Matrix Aggregation

    swap srcmask and dstmark order (ToS Prefix Matrix Aggregation)
    inputInt/OutputInt is before ToS/Reserved/Pad (ToS AS Aggregation)

    Close: #20021

    (cherry picked from commit 34180b62bb3f82c8b71a8744f7f7f73fcd042375)

    Co-authored-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit 4a7b5b51a3
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 2 11:29:41 2024 -0700

    HTTP: Add a null check

    (cherry picked from commit b47523a5cacaaaf6080cde31e72a1961626f491e)

commit cbc02dbce0
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 2 11:22:51 2024 -0700

    Qt: Add null checks

    Add a couple of null checks to WiresharkMainWindow and LograyMainWindow.
    Avoid null checks for summary->ifaces in CaptureFilePropertiesDialog.

    (cherry picked from commit d2495129eac0d38f228c7e9dac6861f6d22e22de)

commit e5bb5c6e56
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 2 10:08:43 2024 -0700

    ProtoBuf: Add a null check

    (cherry picked from commit cf3c112b6d3621b82350b592c10178dc846aff92)

commit 3cb1ec8309
Author: Gerald Combs <gerald@wireshark.org>
Date:   Mon Sep 2 10:01:23 2024 -0700

    ERF: Add a null check

    (cherry picked from commit 1eeb06f1df6788aca1df387618a694d48ff88d33)

commit 2586e2a46d
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Mon Sep 2 12:48:16 2024 +0000

    kerberos: remove unused return of wmem_list_frame_data (Fix Coverity)

    (cherry picked from commit 6d9d3d8b997cdebeee00383f5c4282edf26b0bab)

    Co-authored-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit e9fb5796c8
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Tue Aug 20 06:18:44 2024 +0000

    Clang: Fix Dead Assignment found by Clang Analyzer

    (cherry picked from commit e103cefcc3758d48d411ab791ad5e47c7becdc5e)

    Co-authored-by: Alexis La Goutte <alexis.lagoutte@gmail.com>

commit b65ba40823
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 1 11:21:24 2024 -0700

    SSyncP: Add a null check

    (cherry picked from commit a23bb9fe90326f4abf3fd12838b2c4dbac51a05c)

commit 5e6c872146
Author: John Thacker <johnthacker@gmail.com>
Date:   Sun Sep 1 11:34:57 2024 +0000

    NSIS: Install USBPcapCMD to the correct extcap directory

    There's separate directories for wireshark and logray now.

    (cherry picked from commit 2baa674dab395c5772e5cb36d6c2875c1d3ae473)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 46600d48e9
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Sep 1 09:31:31 2024 +0000

    [Automatic update for 2024-09-01]

    Update manuf, services enterprise numbers, translations, and other items.

commit 4145767f73
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Aug 31 17:14:49 2024 +0000

    tests: Add checking for Lua support to release tests

    Lua support is optional in general, but if --enable-release
    is given to the tests (as on the macOS Intel and Arm package
    builders) fail if support is missing.

    Prevent #20029 from happening again.

    (cherry picked from commit 1f7356e36026acad12c668f1392955efdeb33609)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 97ffc68fee
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Aug 31 13:38:50 2024 +0000

    CMake: Respect TEST_EXTRA_ARGS, run release suite when requested

    With the transition to using pytest, the CMake variable TEST_EXTRA_ARGS
    stopped being used; several of the CI jobs are passing it, to no effect.

    Note that this only has an effect with the `ninja test` target.
    Running pytest directly requires passing in parameters manually.

    However, we also install pytest inside a venv on gitlab macOS runner
    jobs. So use the test target on the macOS package jobs, and instead
    pass the text arguments to pytest on the GitLab macOS runners.

    (cherry picked from commit 983f92001504a044aa10e73c23b5d1be7721ae07)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 3c42dae225
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sat Aug 31 09:39:26 2024 +0000

    lwm2mtlv: Fix Connectivity Monitoring LAC resource

    Fix typo in Connectivity Monitoring LAC resource.

    (cherry picked from commit e6aa94898ed73a8008f74ec0c8bbb26d692cde97)

    Co-authored-by: Stig Bjørlykke <stig@bjorlykke.org>

commit 3e4f2e2591
Author: Anders Broman <a.broman58@gmail.com>
Date:   Fri Aug 30 20:11:34 2024 +0000

    GTPv1: If Utran contaner length is zero don't try to decode it.

    (cherry picked from commit 9f65744fd3561fd413604be2c8ac3bee9188617b)

    Co-authored-by: Anders Broman <a.broman58@gmail.com>

commit e2b6a49284
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Aug 30 22:24:54 2024 +0000

    Fix usage of an invalid patchlevel macro

    (cherry picked from commit eb72ea6fc8ff99ecc3c5fd856bfe2f8b8d08a007)

    Co-authored-by: Franciszek Witt <franek.witt@gmail.com>

commit 0dff200970
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Aug 30 12:20:12 2024 -0700

    NSIS+WiX: Add the ipaddr plugin

    Fixes #20030

    (cherry picked from commit 38ea43d9386b00f77cf7a4b32715b3b5c7781e17)

commit ff39f7cd7a
Author: Gerald Combs <gerald@wireshark.org>
Date:   Fri Aug 30 10:36:30 2024 -0700

    dfilter ipaddr plugin: Small grammar fix

    (cherry picked from commit e384b0dee0a0241e29b343849cc9a7033fd3c50f)

commit 3b544198fe
Author: John Thacker <johnthacker@gmail.com>
Date:   Fri Aug 30 10:37:38 2024 -0400

    dfilter ipaddr plugins: Fix semantic check

    Since the unparsed type was brought back, we need to resolve
    unparsed to fields.

    We can actually manage to support a few new complicated but useless filters:
            ip_rfc1918(ip.src) == ip_rfc1918(127.0.0.1)

    A large number of possible filters that involve putting a literal
    value into the function will still fall afoul of the "filter can not
    be a constant" though.

    Also, have the ip_rfc1918 function only support FT_IPv4, and
    the ip_ula function only support FT_IPv6.

    (cherry picked from commit f13b226d105af3108be7aeadc355524f7590d44f)

commit b8f2317945
Author: John Thacker <johnthacker@gmail.com>
Date:   Fri Aug 30 15:25:38 2024 +0000

    dfilter: Fix error message comparing a function to a wrong type

    The LHS is the function here, not argument 2, which is already
    known in this path to be a field.  Fixes:

     ** (wireshark:1653194) 09:56:11.413173 [DFilter ERROR] epan/dfilter/sttype-function.c:134 -- sttype_function_name(): Magic num is 0xfc2002cf, but should be 0xe10f0f99
     ** (wireshark:1653194) Aborting on fatal log level exception

    (cherry picked from commit 46bacbbce39c0fa01e42bd3948208e8716ee8e81)

    Co-authored-by: John Thacker <johnthacker@gmail.com>

commit 440e6c628d
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Aug 30 06:25:51 2024 +0000

    cllog: fix handling of EOF when processing the header.

    The loop that processes the header comments can either terminate on an
    EOF or error on on seeing a non-comment line.  Set linep on each trip
    through the loop, so that, if it's null, we know the loop was terminated
    due to an error or EOF; otherwise, it was terminated by a non-comment
    line, which is in the line buffer.  Only parse the line buffer if
    there's a non-comment line in the buffer.

    Include the test for a comment line in the loop test.

    (cherry picked from commit df34522dbc1193cae23e8823a0e0bfd05188cab7)

    Co-authored-by: Guy Harris <gharris@sonic.net>

commit ddd9d4092b
Author: Guy Harris <gharris@sonic.net>
Date:   Fri Aug 30 00:19:28 2024 +0000

    cllog: fix error handling when opening a file.

    Don't check for errors if file_gets() *succeeds*, check if it *fails*,
    i.e. do the check after the loop is done.

    To do that, call file_error() to get the error code, rather than
    assuming *err magically gets set.

    If HeaderMapping->parseFunc() fails, treat that as a "not our file"
    condition rather than an error condition.

    (cherry picked from commit 7b39f746659685b2c7457e371bc434505a7139f6)

    Co-authored-by: Guy Harris <gharris@sonic.net>

commit 7dc8dd6a67
Author: Guy Harris <gharris@sonic.net>
Date:   Thu Aug 29 23:16:47 2024 +0000

    commview: fix handling of NCFX files that aren't ours.

    If commview_ncfx_read_header() returns WTAP_ERR_BAD_FILE, it doesn't
    mean we got an error, it means it's probably not a Commview NCFX file.
    Check for that and, if we get it, free the error message and return
    WTAP_OPEN_NOT_MINE.

    (cherry picked from commit 5d51e23dc67ba54e321de3d5983a0660ba71339a)

    Co-authored-by: Guy Harris <gharris@sonic.net>

commit 6d15b317da
Author: Guy Harris <gharris@sonic.net>
Date:   Wed Aug 28 23:04:41 2024 +0000

    pcap: use nanosecond resolution for hardware lcap files.

    The resolution on Ixia hardware-capture lcap files appears to be higher
    than 1 microsecond; assume it's 1 nanosecond.

    Also:

    Make a Boolean variable a bool rather than an int.  Rename it to
    skip_ixia_extra, to clarify that it's for the Ixia formats.

    Use a null buffer argument to wtap_read_bytes() to skip over the size
    information.

    Point to the issue for adding support for Ixia lcap files.

    Ping #14073.

    (cherry picked from commit 58f6fef9c8090d5733ac2103005815ecf84ab3bd)

    Co-authored-by: Guy Harris <gharris@sonic.net>

commit b809cc02d8
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Aug 28 15:50:03 2024 -0700

    Version: 4.4.0 → 4.4.1

    [skip ci]
