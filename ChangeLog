commit 4ee79d0b75
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Jan 2 21:28:02 2024 -0500

    TCPCL: Do not call g_int64_hash on a gint

    Do not call g_int64_hash on a pointer to a gint (which might
    be 32 bit). Call g_int_hash instead.

    Fixes use of unitialized value.

    (cherry picked from commit 329523afee81e7f14c88fbe4ca82d8de9f53d7e7)

commit 0fad8d9fc0
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Jan 2 14:11:04 2024 -0800

    Prep for 4.0.12

    [skip ci]

commit 496679c1c3
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Dec 31 15:06:40 2023 -0800

    asn2wrs: Add recursion checks

    Add a recursion depth check whenever we have cyclic dependencies.
    Regenerate our dissectors.

    Fixes #19501

    (cherry picked from commit 8f797db63ca44875a07d0d8a5d298a79d09b44ec)

    Conflicts:
            epan/dissectors/packet-cmip.c
            epan/dissectors/packet-cmp.c
            epan/dissectors/packet-dap.c
            epan/dissectors/packet-disp.c
            epan/dissectors/packet-e2ap.c
            epan/dissectors/packet-glow.c
            epan/dissectors/packet-goose.c
            epan/dissectors/packet-h225.c
            epan/dissectors/packet-h245.c
            epan/dissectors/packet-h248.c
            epan/dissectors/packet-ieee1609dot2.c
            epan/dissectors/packet-ldap.c
            epan/dissectors/packet-mms.c
            epan/dissectors/packet-p22.c
            epan/dissectors/packet-p7.c
            epan/dissectors/packet-x509if.c
            epan/dissectors/packet-x509sat.c
            epan/dissectors/packet-z3950.c

commit 452809f995
Author: Ilya Kulakov <kulakov.ilya@gmail.com>
Date:   Wed Dec 20 12:31:03 2023 -0800

    ChmodBPF: Specify AssociatedBundleIdentifiers in the Launch Daemon property list

    As per https://developer.apple.com/documentation/servicemanagement/updating_helper_executables_from_earlier_versions_of_macos

    (cherry picked from commit e07603d512bee0932c56205cbf55949d6bf55b8d)

commit db1637d9c7
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Mon Jan 1 12:25:09 2024 +0100

    Happy New Year 2024

    (cherry picked from commit 322ae0f0d86e62cedbea74dbe85fd9ca98d7f3a6)

commit 726ddf92c9
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Dec 31 16:21:21 2023 +0000

    [Automatic update for 2023-12-31]

    Update manuf, services enterprise numbers, translations, and other items.

    services failed.

commit 86b2048754
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sun Dec 31 12:56:53 2023 +0100

    pcap: Update link_type_vals

    (cherry picked from commit 17fcdb4735113b155994254cc10ce733b82c00e2)

commit 8e5211be57
Author: Guy Harris <gharris@sonic.net>
Date:   Sat Dec 30 21:58:01 2023 -0800

    dumpcap: treat connect errors as remote capture errors.

    Treat errors beginning with "Is the server properly installed?" similarly
    to "The other host terminated the connection.", and don't tell the user
    to report them as Wireshark bugs.

    This should clear up at least some of the Wireshark side of #14920.
    (Libpcap should do a better job of reporting errors as well, although
    that will ultimately involve better libpcap APIs, for which there are
    other reasons as well.)

    (cherry picked from commit dc6f197726f8fbe60d2d9204ffefd22a6c470913)

commit 53d09b91a0
Author: Ferry Huberts <ferry.huberts@pelagic.nl>
Date:   Thu Dec 28 21:58:05 2023 +0100

    packet-sv: fix the seqData validity

    Update to the latest specification, which specifies the currently used
    value for 'invalid' as 'backward compatible (do not use)'.

    See
      IEC 61850-9-2 Edition 2.1 2020-02,
      Section 8.6 Definitions for basic data types – Presentation layer functionality,
      Table 21

    Be aware that in the specification the bits are numbered in reverse (it
    specifies the least significant bit as bit 31 instead of as bit 0)!

    Signed-off-by: Ferry Huberts <ferry.huberts@pelagic.nl>

    (cherry picked from commit 1ccbc482a07683cddcd04df368e6d941bca993b1)

commit 91faf9463b
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Thu Dec 28 11:22:14 2023 +0100

    Bluetooth: update UUID and Company ID registry

    Pull current values from the Bluetooth SIG registry, while keeping
    old values around. Don't be afraid for UTF-8.

    (cherry picked from commit 1d6abf627c68e0907602f4b3b05479288b15ed56)

commit 391df31c62
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Dec 27 20:51:09 2023 +0100

    BT_ATT: Adjust ranges for protocol registration

    With the growth of the member registry they became part of the
    protocol registrations for use with decode as.
    Extend the code space reserved for member registrations, to
    exclude these and new members for the foreseeable future.

    (cherry picked from commit 2dae7c2d797a9df0fd9fd7244badbb9f3c465db0)

commit a176e35c6c
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Wed Dec 27 20:57:27 2023 +0100

    BTL2CAP: Switch to using more efficient bluetooth_uuid_vals_ext

    (cherry picked from commit 64b9bad19919337845ef7112e5d2c25168d3ac3e)

commit 524e547b28
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Dec 24 16:20:20 2023 +0000

    [Automatic update for 2023-12-24]

    Update manuf, services enterprise numbers, translations, and other items.

    services failed.

commit 93bdebc458
Author: Tomasz Moń <desowin@gmail.com>
Date:   Wed Nov 29 18:30:26 2023 +0100

    Qt: Fix profile menu widget parent relationships

    Prevent crash after profile import by correctly setting import menu
    parent. Set profile menu delete on close attribute only on left click to
    prevent the "Switch to" menu from disappearing after first time the
    submenu is shown and mouse is moved away.

    While the symptoms of the issue this commit fixes are the same as #18875
    the actual reason behind the crash is different. In other words, this
    crash after profile import is fixed only if this commit is used together
    with Qt version that has QTBUG-106718 fixed.

    (cherry picked from commit c001d55cc42ba0e555bdc7ff40dcb1b11f2db8b8)

commit 2b7bcf63b9
Author: John Thacker <johnthacker@gmail.com>
Date:   Wed Dec 20 11:05:17 2023 -0500

    Qt: connect SCTP All Associations Analyze button correctly

    The filterPackets signal takes a QString by value, not by
    reference (which is fine in Qt due to implicit sharing), and
    must be connected correctly to work (at least on Qt6):

     ** (wireshark:829501) 10:56:20.423294 [GUI WARNING] -- QObject::connect: No such signal SCTPAssocAnalyseDialog::filterPackets(QString&,bool) in ui/qt/sctp_all_assocs_dialog.cpp:98
     ** (wireshark:829501) 10:56:20.423357 [GUI WARNING] -- QObject::connect:  (sender name:   'SCTPAssocAnalyseDialog')
     ** (wireshark:829501) 10:56:20.423382 [GUI WARNING] -- QObject::connect:  (receiver name: 'WiresharkMainWindow')

    Related to #19544

    (cherry picked from commit a0d904896dcc53f54023df26b85fcbc5b2533ee6)

commit 1dbfa5126e
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Dec 18 17:16:28 2023 -0500

    Qt: Don't clear selected interface when auto sorting

    Use layoutAboutToBeChanged() and layoutChanged() instead of
    beginResetModel() / endResetModel(). It still causes a sort
    but doesn't clear the selected item.

    Fix #19133

    (cherry picked from commit 71344aa160b115e75443e763ca00f5dbea9d7b64)

commit 346644b537
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Dec 17 16:20:04 2023 +0000

    [Automatic update for 2023-12-17]

    Update manuf, services enterprise numbers, translations, and other items.

    services failed.

commit 1bec7182a8
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Dec 13 09:13:59 2023 -0800

    GitLab CI: Switch to clang 17

    (cherry picked from commit 5353057795700e71ad1ea250c648f6c11065e3e7)

    Conflicts:
            .gitlab-ci.yml

commit 13fd75cbb7
Author: John Thacker <johnthacker@gmail.com>
Date:   Tue Dec 12 20:49:51 2023 -0500

    Qt: Don't connect in the .ui file only to disconnect in constructor

    Don't connect the QDialogButtonBox accepted() signal to the
    dialog's accept() slot in the Qt Creator .ui XML only to
    disconnect that connection in the constructor.

    Apparently in Qt6 these things are parsed in somewhat different
    order, so the disconnection wasn't happening, leading to
    destroying the dialog while the FileDialog was still open.

    There's a case for moving the Save As actions to ActionRole buttons
    (though then the little save icon would have to be set manually.)

    Fix #19529

    (cherry picked from commit 897c94bd0422fb72c57aabddac91c8a0b8523156)

commit 176768c733
Author: Gerald Combs <gerald@wireshark.org>
Date:   Tue Dec 12 14:58:18 2023 -0800

    Windows: Upgrade GnuTLS to 3.8.2

    (cherry picked from commit ac524cff38c80a20b8a8a10ab261c23cd2f2fbad)

    Conflicts:
            tools/win-setup.ps1

commit 7b9009e7ae
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Dec 10 16:20:16 2023 +0000

    [Automatic update for 2023-12-10]

    Update manuf, services enterprise numbers, translations, and other items.

commit 25f1fa138c
Author: Guy Harris <gharris@sonic.net>
Date:   Sat Dec 9 14:20:13 2023 -0800

    release notes: note support for if_tsoffset option in pcapng.

commit c6c0ddc550
Author: Guy Harris <gharris@sonic.net>
Date:   Sat Dec 9 12:15:50 2023 -0800

    nflog: time stamps are in seconds/microseconds, not seconds/nanoseconds.

    See

    1. https://www.tcpdump.org/linktypes/LINKTYPE_NFLOG.html

    2. The `nla_put(inst->skb, NFULA_TIMESTAMP, sizeof(ts), &ts))`
       call in net/netfilter/nfnetlink_log.c in the Linux kernel source.

    Add support for 16-byte and 12-byte seconds/microseconds time stamp, to
    match what we already have for seconds/nanoseconds time stamps, in
    `proto_tree_add_item()` etc., and use that.

    Fixes #19525.

    (cherry picked from commit 17d479f87604da3859cb79323b6ce63d49f0af44)

commit d87da5d9a1
Author: Paul Aurich <paul@darkrain42.org>
Date:   Fri Dec 8 12:36:18 2023 -0800

    debian: fix names of added symbols

    Fixes: 318461fb26 ("debian: add more new symbols.")
    Change-Id: Iadf7bb68094f433a37b53cf8c8b1ea5c894f1315

commit 46428103b8
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu Dec 7 18:18:49 2023 -0800

    GitLab CI: Make sure we set the ccache size in our fuzz jobs

    (cherry picked from commit 9a9b2e114fe29bfed31f29c231da8a975434d2b8)

commit 220fb4db32
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Dec 3 16:21:36 2023 +0000

    [Automatic update for 2023-12-03]

    Update manuf, services enterprise numbers, translations, and other items.

    services failed.

commit 3dbeebf644
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Nov 12 11:30:53 2023 -0800

    Windows: Make sure we ship our minizip DLL

    (cherry picked from commit b64a54b43bb2e49fca7b543c95e3a39c4f870d8d)

    Conflicts:
            packaging/nsis/CMakeLists.txt
            packaging/wix/CMakeLists.txt

commit f03e7c8f52
Author: Guy Harris <gharris@sonic.net>
Date:   Tue Nov 28 22:43:48 2023 -0800

    pcapng: support the if_tsoffset option.

    When calculating packet timestamps, add the timestamp offset to the
    seconds value of the timestamp.

    At least one DPDK developer considered using if_tsoffset, but abandoned
    the idea because of the lack of Wireshark support:

    https://lore.kernel.org/all/36758990.XM6RcZxFsP@thomas/t/#mafbe5280ba947327be1798bf15e0781d63b049a7

    and the pcapng code in the Rust pcap_parser crate:

    https://docs.rs/pcap-parser/latest/pcap_parser/

    supports if_tsoffset.

    libpcap doesn't currently support it, but I'll be changing it to do so.

    While we're at it, update comments to reflect the deprecation of
    if_tzone (never well defined, and, unless you can map them to IANA
    timezone names or something such as that, far from sufficient to allow
    converting UTC to the appropriate local time), and the clarification of
    the definition of if_tsoffset, in the pcapng spec.

    (backported from commit 1c2093eec8dc8667c9f6b7c5ec9f67e0c86c7571)

commit 318461fb26
Author: Guy Harris <gharris@sonic.net>
Date:   Tue Nov 28 10:47:57 2023 -0800

    debian: add more new symbols.

commit 9fdc040aaa
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Tue Nov 28 12:59:16 2023 +0100

    BACapp: Update BACnet ID's

    Port the generator script to Python3; don't be afraid of UTF-8.
    Use the output to update the  vendor ID value strings in the bacapp
    dissector. Back port additional changes/corrections to value strings.

commit 858ee58d19
Author: Guy Harris <gharris@sonic.net>
Date:   Tue Nov 28 00:17:23 2023 -0800

    libwiretap: add support for signed integer-valued options.

    if_tsoffset is one such option in pcapng.

    (backported from commit a8eef49a9edc372b1ea1ec06bb7d9cf6b9fa91a5)

commit 06eeb26fa8
Author: Guy Harris <gharris@sonic.net>
Date:   Mon Nov 27 22:58:41 2023 -0800

    Handle the if_fcslen option as having an unsigned 1-byte value.

    That's how it's defined in pcapng.  Internally, we have a per-interface
    FCS length value that's a signed 32-bit value, with -1 meaning
    "unknown", but all possible values of if_fcslen fit in there.

    When printing it, print it as unsigned.

    (cherry picked from commit 14c524a278ee71de4120a5614da2d0493655b327)

commit 7847eb1976
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Mon Nov 27 12:11:15 2023 +0100

    icmpv6: Make ND_RA_FLAG_RSV the two last bits

    The two last bits in Router Advertisement flags are reserved.

    (cherry picked from commit 83c94249b493e96dc5611045e9422e828d0853ec)

commit 6ee1c837bc
Author: Guy Harris <gharris@sonic.net>
Date:   Mon Nov 27 20:50:46 2023 -0800

    editcap: fix a tpyo in a comment.

    [skip ci]

    (cherry picked from commit 10eece14e3b87a904e51de5c94c83a16ed526822)

commit 40de019d33
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Nov 26 16:19:45 2023 +0000

    [Automatic update for 2023-11-26]

    Update manuf, services enterprise numbers, translations, and other items.

commit 5ffd71b7b9
Author: Stig Bjørlykke <stig@bjorlykke.org>
Date:   Sat Nov 25 16:21:02 2023 +0100

    Qt: Disable Ok button on invalid range preference

    Disable the Ok button when having a invalid range preference.
    This also prevents a crash in on_buttonBox_accepted() when doing
    pref_unstash().

    Enable Ok button for string preference.

    (cherry picked from commit d762dd521a34cf6c85d221fda7bd60e5cbb224ef)

commit 0a0669c9d4
Author: John Thacker <johnthacker@gmail.com>
Date:   Thu Nov 23 13:47:51 2023 -0500

    gvcp: Don't try to add a NULL string to a column

    This was caught as an invalid argument by g_strlcpy before 4.2,
    but it was never a good idea.

    Fix #19496

    (backported from commit a8586fde3a6512466afb2a660538ef3fe712076b)

commit eba4b89b3a
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Thu Nov 23 20:43:12 2023 +0000

    RTCP: Add MCPTT values from TS 24.380 V17.7.0

commit 1566693dde
Author: Jaap Keuter <jaap.keuter@xs4all.nl>
Date:   Thu Nov 23 19:46:00 2023 +0000

    TLS: recognize ech_required alert

commit 2068670873
Author: Gerald Combs <gerald@wireshark.org>
Date:   Thu Nov 23 11:03:07 2023 -0800

    GitLab CI: Remove the ABI Check job

commit f979f58969
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Tue Nov 21 20:55:50 2023 +0100

    isakmp: update dh_group value_string with RFC8031 and RFC9385

    Add new following dh group :

    31      Curve25519 [RFC8031]
    32      Curve448 [RFC8031]
    33      GOST3410_2012_256 [RFC9385]
    34      GOST3410_2012_512 [RFC9385]

    https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-8

    (cherry picked from commit 3570a9a2191c119fcbf32b36d58d3c6637bebb08)

commit e3ddf6b5e6
Author: Alexis La Goutte <alexis.lagoutte@gmail.com>
Date:   Tue Nov 21 20:45:45 2023 +0100

    GVCP: add ASCII (0x02) to Character Set value_string

    Close: #19494

    (cherry picked from commit afb03fa5152a06b25c269f38228814312fdbcaa8)

commit b563edf001
Author: John Thacker <johnthacker@gmail.com>
Date:   Mon Nov 20 20:16:57 2023 -0500

    Qt: Prevent infinite recursive stack smash in CaptureOptionsDialog

    updateInterfaceColumns can call setData, which triggers a line
    of signals QAbstractItemMode::dataChanged -> QTreeWidget::itemChanged
     -> CaptureInterfacesDialog::interfaceItemChanged->
     back to InterfaceTreeWidgetItem::updateInterfaceColumns again.

    Block the signals so that doesn't happen. It's rare, but can
    happen with cards that falsely report that they support monitor
    mode but then turn out not to so when we try to actually set
    monitor mode (23d1fed59f20e813088252bac268df142fa96e80)

    Fixes #16693

    (cherry picked from commit d1699f0c674df41acd58a377ac509199f4b77849)

commit 39a627a6de
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sat Nov 18 17:54:00 2023 -0800

    ZigBee ZCL: Fix an array bounds check

    Use the correct value when checking the bounds of ett_zbee_zcl_sel. Our
    ett definitions are only used in the C module, so move them there. Fix a
    name.

    Fixes #19490

    (cherry picked from commit a9b0dc0aa7e5d6e0ddc8ee4010106fc2a44dc8d9)

    Conflicts:
            epan/dissectors/packet-zbee-zcl.c
            epan/dissectors/packet-zbee-zcl.h

commit 41e1920752
Author: Gerald Combs <gerald@wireshark.org>
Date:   Sun Nov 19 16:20:20 2023 +0000

    [Automatic update for 2023-11-19]

    Update manuf, services enterprise numbers, translations, and other items.

commit 0d88797850
Author: John Thacker <johnthacker@gmail.com>
Date:   Fri Nov 17 20:47:55 2023 -0500

    Fix saving recently used capture filters

    The recently used capture filters list was organized so that
    the newest filters were last, but when writing to recent_common
    we start with the beginning of the list and write up to the max.
    This meant that only the first 20 entries ever used for a profile
    would be written, after which the list would be frozen.

    Fix that. The best way to do that is to keep the most recently
    used filter first, in presentation order, by prepending each
    filter. That way we can AddItems to the combo boxes and write
    to the file in the natural way. In order to do so, we have to
    reverse the list after reading all the entries from the recent_common
    file on startup. This also has better performance, as it's O(N) to
    prepend a bunch of list items and them reverse them, but O(N^2)
    to add N list items to the end of a linked-list (that doesn't have
    a pointer to the end, unlike a GQueue.)

    Fix #12918

    (cherry picked from commit 2b4c88cb42182b05dafd7fac5ffc88783f9f618a)

commit 23ab019283
Author: John Thacker <johnthacker@gmail.com>
Date:   Sat Nov 18 06:57:06 2023 -0500

    Qt: Don't try to compile capture filters for unknown dlts

    If an interface's active_dlt is set to -1 (an invalid value, used
    when permissions are bad, or set by CaptureOptionsDialog for
    "link-layer types libpcap/WinPcap/Npcap doesn't know about"),
    don't try to compile and check capture filters. Give the same
    yellow Deprecated background and warning about being unable to
    check the capture filter as for the DLT_USER types, instead of a
    cryptic error message.

    Fix #19480

    (cherry picked from commit 49f5bea629c6160b20faf46bac506e1862b257b6)

commit 87c0be3a2d
Author: Gerald Combs <gerald@wireshark.org>
Date:   Wed Nov 15 13:03:38 2023 -0800

    Version: 4.0.11 → 4.0.12

    [skip ci]
